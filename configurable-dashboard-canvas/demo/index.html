<!DOCTYPE html>
<html lang="en-GB">
  <head>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="./index.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.2/jspdf.min.js"></script>

    <script src="../src/dashboard-components/drag-util.js" defer></script>
    <script src="../src/dashboard-components/Canvas.js" type="module"></script>

    <script
      src="../src/dashboard-components/Navigation.js"
      type="module"
    ></script>
    <script src="../src/dashboard-components/Header.js" type="module"></script>
  </head>
  <style>
    #div {
      width: 500px;
      height: 500px;
      border: 1px solid black;
    }
  </style>
  <body>
    <h1>HTML Canvas to Image</h1>
    <button type="button" id="btnDisplay">Display</button>
    <button type="button" id="btnDownload">Download</button>
    <hr />
    <canvas
      id="myCanvas"
      width="400"
      height="250"
      style="border: 2px solid black; float: left"
    ></canvas>
    <img
      src=""
      id="imgConverted"
      style="float: left; border: 2px solid blue; margin-left: 10px"
    />
    <button onclick="javascript:demoFromHTML()">PDF</button>
    <div id="dashboard">
      <header-component id="header"></header-component>
      <navigation-component id="navigation"></navigation-component>
      <div id="display">
        <canvas-component id="canvas"></canvas-component>
      </div>
    </div>
    <script>
      function demoFromHTML() {
        var pdf = new jsPDF("p", "pt", "letter");
        // source can be HTML-formatted string, or a reference
        // to an actual DOM element from which the text will be scraped.
        source = document.getElementById("canvas").shadowRoot;
        console.log(document.getElementById("page"));

        // we support special element handlers. Register them with jQuery-style
        // ID selector for either ID or node name. ("#iAmID", "div", "span" etc.)
        // There is no support for any other type of selectors
        // (class, of compound) at this time.
        specialElementHandlers = {
          // element with id of "bypass" - jQuery style selector
          "#bypassme": function (element, renderer) {
            // true = "handled elsewhere, bypass text extraction"
            return true;
          },
        };
        margins = {
          top: 80,
          bottom: 60,
          left: 40,
          width: 522,
        };
        // all coords and widths are in jsPDF instance's declared units
        // 'inches' in this case
        pdf.fromHTML(
          source, // HTML string or DOM elem ref.
          margins.left, // x coord
          margins.top,
          {
            // y coord
            width: margins.width, // max width of content on PDF
            elementHandlers: specialElementHandlers,
          },

          function (dispose) {
            // dispose: object with X, Y of the last line add to the PDF
            //          this allow the insertion of new lines after html
            pdf.save("Test.pdf");
          },
          margins
        );
      }
    </script>
    <script>
      const btnDisplay = document.querySelector("#btnDisplay");
      const btnDownload = document.querySelector("#btnDownload");
      const imgConverted = document.querySelector("#imgConverted");
      const myCanvas = document.querySelector("#myCanvas");
      const ctx = myCanvas.getContext("2d");

      ctx.font = "50px Roboto";
      ctx.fillStyle = "red";
      ctx.fillText("dcode", 100, 100);
      ctx.fillRect(200, 150, 150, 75);

      btnDisplay.addEventListener("click", function () {
        const dataURI = myCanvas.toDataURL();
        console.log(dataURI);
      });
    </script>
  </body>
</html>
